"use client";var _=Object.create;var u=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var z=(a,r)=>{for(var i in r)u(a,i,{get:r[i],enumerable:!0})},k=(a,r,i,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let c of B(r))!D.call(a,c)&&c!==i&&u(a,c,{get:()=>r[c],enumerable:!(t=P(r,c))||t.enumerable});return a};var v=(a,r,i)=>(i=a!=null?_(j(a)):{},k(r||!a||!a.__esModule?u(i,"default",{value:a,enumerable:!0}):i,a)),T=a=>k(u({},"__esModule",{value:!0}),a);var O={};z(O,{FarcasterEmbed:()=>F});module.exports=T(O);var b=v(require("react")),I=v(require("linkify-react"));var g=v(require("react")),w=require("react/jsx-runtime");function y({source:a,poster:r,aspectRatio:i}){let[t,c]=g.default.useState(!1),[n,s]=g.default.useState(!1),h=d=>new Promise((p,m)=>{let l=document.createElement("script");l.src=d,l.type="module",l.onload=()=>p(l),l.onerror=()=>m(new Error(`[react-farcaster-embed] Script load error for ${d}`)),document.head.appendChild(l)});return g.default.useEffect(()=>{let d="https://cdn.jsdelivr.net/npm/media-chrome@1/+esm",p="https://cdn.jsdelivr.net/npm/hls-video-element@1.0/+esm";return h(d).then(()=>{console.log("Media Chrome loaded successfully"),c(!0)}).catch(m=>{console.error("Media Chrome loading failed",m)}),h(p).then(()=>{console.log("HLS Video Element loaded successfully"),s(!0)}).catch(m=>{console.error("HLS Video Element loading failed",m)}),()=>{document.head.removeChild(document.head.querySelector(`script[src="${d}"]`)),document.head.removeChild(document.head.querySelector(`script[src="${p}"]`))}},[a,r,i]),(0,w.jsx)("div",{style:{aspectRatio:i},children:t&&n&&(0,w.jsx)("div",{className:"farcaster-embed-video-player",dangerouslySetInnerHTML:{__html:`<media-controller>
            <hls-video
              src="${a}"
              slot="media"
              volume="1"
              crossorigin
              playsinline
            ></hls-video>
            <media-poster-image
              slot="poster"
              src="${r}">
            </media-poster-image>
            <media-loading-indicator slot="centered-chrome" noautohide></media-loading-indicator>
            <media-control-bar>
              <media-play-button></media-play-button>
              <media-time-range></media-time-range>
              <media-time-display showduration remaining></media-time-display>
              <media-fullscreen-button></media-fullscreen-button>
            </media-control-bar>
          </media-controller>`}})})}var o=require("react/jsx-runtime"),L=()=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),C=()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M17 2.1l4 4-4 4"}),(0,o.jsx)("path",{d:"M3 12.2v-2a4 4 0 0 1 4-4h12.8M7 21.9l-4-4 4-4"}),(0,o.jsx)("path",{d:"M21 11.8v2a4 4 0 0 1-4 4H4.2"})]}),N=()=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),U=()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,o.jsx)("circle",{cx:"12",cy:"12",r:"3"})]}),S=()=>(0,o.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 1260 1260",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsxs)("g",{clipPath:"url(#fc-embed-clip1)",children:[(0,o.jsx)("path",{d:"M947.747 1259.61H311.861C139.901 1259.61 0 1119.72 0 947.752V311.871C0 139.907 139.901 0.00541362 311.861 0.00541362H947.747C1119.71 0.00541362 1259.61 139.907 1259.61 311.871V947.752C1259.61 1119.72 1119.71 1259.61 947.747 1259.61Z",fill:"#472A91"}),(0,o.jsx)("path",{d:"M826.513 398.633L764.404 631.889L702.093 398.633H558.697L495.789 633.607L433.087 398.633H269.764L421.528 914.36H562.431L629.807 674.876L697.181 914.36H838.388L989.819 398.633H826.513Z",fill:"white"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"fc-embed-clip1",children:(0,o.jsx)("rect",{width:"1259.61",height:"1259.61",fill:"white"})})})]});var e=require("react/jsx-runtime"),q={className:"farcaster-embed-body-link",target:"_blank"},A=async(a,r)=>{try{let t=await(await fetch(`https://client.warpcast.com/v2/user-thread-casts?castHashPrefix=${r}&username=${a}&limit=5`)).json();return t.result.casts[0].castType==="root-embed"?t.result.casts[1]:t.result.casts[0]}catch{throw new Error("Unable to fetch cast.")}};function F({url:a,username:r,hash:i}){let[t,c]=b.default.useState(null);if(a){let n=a.split("/");r=n[3],i=n[4]}if(!r||!i)throw new Error("You must provide a Warpcast URL or username and hash to embed a cast.");return b.default.useEffect(()=>{(async()=>{let s=await A(r,i),h=s.author,d=`https://warpcast.com/~/profiles/${h.fid}`,p=new Date(s.timestamp),m={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0},l=p.toLocaleString("en-US",m),x=`https://warpcast.com/${h.username}/${s.hash}`,H=s.replies&&s.replies.count,M=s.reactions&&s.reactions.count,V=s.combinedRecastCount?s.combinedRecastCount:s.recasts.count,E=s.watches&&s.watches.count,f=s.embeds&&s.embeds.images,$=f&&f.length>0,R=s.embeds&&s.embeds.videos&&s.embeds.videos.length>0,W=s.embeds&&s.embeds.videos;c({cast:s,author:h,profileUrl:d,timestamp:l,warpcastUrl:x,replies:H,likes:M,recasts:V,watches:E,images:f,hasImages:$,hasVideos:R,videos:W})})()},[r,i]),t?(0,e.jsxs)("div",{className:"not-prose farcaster-embed-container",children:[(0,e.jsxs)("div",{className:"farcaster-embed-metadata",children:[(0,e.jsx)("a",{href:t.profileUrl,className:"farcaster-embed-avatar-link",children:(0,e.jsx)("img",{src:t.author.pfp.url,alt:`@${t.author.username}`,width:48,height:48,className:"farcaster-embed-author-avatar"})}),(0,e.jsxs)("div",{className:"farcaster-embed-author",children:[(0,e.jsx)("p",{className:"farcaster-embed-author-display-name",children:t.author.displayName}),(0,e.jsxs)("p",{className:"farcaster-embed-author-username",children:["@",t.author.username]})]}),(0,e.jsx)("div",{className:"farcaster-embed-timestamp",children:(0,e.jsx)("p",{children:t.timestamp})})]}),(0,e.jsxs)("div",{className:"farcaster-embed-body",children:[(0,e.jsx)(I.default,{as:"p",options:q,children:t.cast.text}),t.hasImages&&(0,e.jsx)("div",{className:"farcaster-embed-image-container",children:t.images.map(n=>(0,e.jsx)("a",{href:n.url,target:"_blank",className:"farcaster-embed-image-link",children:(0,e.jsx)("img",{src:n.url,alt:n.alt,className:"farcaster-embed-image"})},n.url))}),t.hasVideos&&(0,e.jsx)("div",{className:"farcaster-embed-video-container",children:t.videos.map(n=>(0,e.jsx)(y,{source:n.sourceUrl,aspectRatio:n.width/n.height,poster:n.thumbnailUrl},n.url))})]}),t.cast.tags.length>0&&(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"farcaster-embed-channel",children:[t.cast.tags[0].imageUrl&&(0,e.jsx)("img",{src:t.cast.tags[0].imageUrl,alt:t.cast.tags[0].name,width:16,height:16,className:"farcaster-embed-channel-avatar"}),t.cast.tags[0].name&&(0,e.jsx)("p",{className:"farcaster-embed-channel-name",children:t.cast.tags[0].name})]})}),(0,e.jsxs)("div",{className:"farcaster-embed-stats",children:[(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsxs)("a",{className:"farcaster-embed-stats-link",href:t.warpcastUrl,target:"_blank",children:[(0,e.jsx)(L,{}),(0,e.jsx)("span",{children:t.replies.toLocaleString("en-US")})]})}),(0,e.jsx)("li",{children:(0,e.jsxs)("a",{className:"farcaster-embed-stats-link",href:t.warpcastUrl,target:"_blank",children:[(0,e.jsx)(C,{}),(0,e.jsx)("span",{children:t.recasts.toLocaleString("en-US")})]})}),(0,e.jsx)("li",{children:(0,e.jsxs)("a",{className:"farcaster-embed-stats-link",href:t.warpcastUrl,target:"_blank",children:[(0,e.jsx)(N,{}),(0,e.jsx)("span",{children:t.likes.toLocaleString("en-US")})]})}),(0,e.jsx)("li",{children:(0,e.jsxs)("a",{className:"farcaster-embed-stats-link",href:t.warpcastUrl,target:"_blank",children:[(0,e.jsx)(U,{}),(0,e.jsx)("span",{children:t.watches.toLocaleString("en-US")})]})})]}),(0,e.jsx)("div",{className:"farcaster-embed-warpcast-icon",children:(0,e.jsx)("a",{href:t.warpcastUrl,title:"Show on Warpcast",target:"_blank",className:"farcaster-embed-warpcast-link",children:(0,e.jsx)(S,{})})})]})]}):null}0&&(module.exports={FarcasterEmbed});
//# sourceMappingURL=index.js.map